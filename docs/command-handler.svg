<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="782px" preserveAspectRatio="none" style="width:1542px;height:782px;" version="1.1" viewBox="0 0 1542 782" width="1542px" zoomAndPan="magnify"><defs><filter height="300%" id="ffuskvgu2np5n" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="4.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="8.0" dy="8.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="36" lengthAdjust="spacingAndGlyphs" textLength="320" x="618" y="34.8047">Command handler</text><!--cluster nl.openweb.command-handler.core.clj--><polygon fill="#FFFF00" filter="url(#ffuskvgu2np5n)" points="228.9444,362.3984,780.9444,362.3984,794.9444,407.375,1232.9444,407.375,1232.9444,504.3984,228.9444,504.3984,228.9444,362.3984" style="stroke: #000000; stroke-width: 3.0;"/><line style="stroke: #000000; stroke-width: 3.0;" x1="228.9444" x2="794.9444" y1="407.375" y2="407.375"/><text fill="#000000" font-family="sans-serif" font-size="28" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="540" x="236.9444" y="393.4688">nl.openweb.command-handler.core.clj</text><!--cluster balancedb--><polygon fill="#ADD8E6" filter="url(#ffuskvgu2np5n)" points="144.9444,598.3984,300.9444,598.3984,314.9444,643.375,638.9444,643.375,638.9444,758.3984,144.9444,758.3984,144.9444,598.3984" style="stroke: #000000; stroke-width: 3.0;"/><line style="stroke: #000000; stroke-width: 3.0;" x1="144.9444" x2="314.9444" y1="643.375" y2="643.375"/><text fill="#000000" font-family="sans-serif" font-size="28" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="144" x="152.9444" y="629.4688">balancedb</text><!--entity c--><rect fill="#FEFECE" filter="url(#ffuskvgu2np5n)" height="72.9766" style="stroke: #A80036; stroke-width: 3.0;" width="176" x="1040.9444" y="416.3984"/><rect fill="#FEFECE" height="10" style="stroke: #A80036; stroke-width: 3.0;" width="20" x="1030.9444" y="426.3984"/><rect fill="#FEFECE" height="10" style="stroke: #A80036; stroke-width: 3.0;" width="20" x="1030.9444" y="469.375"/><text fill="#000000" font-family="sans-serif" font-size="28" lengthAdjust="spacingAndGlyphs" textLength="136" x="1060.9444" y="463.4688">consumer</text><!--entity p--><rect fill="#FEFECE" filter="url(#ffuskvgu2np5n)" height="72.9766" style="stroke: #A80036; stroke-width: 3.0;" width="166" x="803.9444" y="416.3984"/><rect fill="#FEFECE" height="10" style="stroke: #A80036; stroke-width: 3.0;" width="20" x="793.9444" y="426.3984"/><rect fill="#FEFECE" height="10" style="stroke: #A80036; stroke-width: 3.0;" width="20" x="793.9444" y="469.375"/><text fill="#000000" font-family="sans-serif" font-size="28" lengthAdjust="spacingAndGlyphs" textLength="126" x="823.9444" y="463.4688">producer</text><!--entity mth--><rect fill="#FEFECE" filter="url(#ffuskvgu2np5n)" height="72.9766" style="stroke: #A80036; stroke-width: 3.0;" width="212" x="244.9444" y="416.3984"/><rect fill="#FEFECE" height="10" style="stroke: #A80036; stroke-width: 3.0;" width="20" x="234.9444" y="426.3984"/><rect fill="#FEFECE" height="10" style="stroke: #A80036; stroke-width: 3.0;" width="20" x="234.9444" y="469.375"/><text fill="#000000" font-family="sans-serif" font-size="28" lengthAdjust="spacingAndGlyphs" textLength="172" x="264.9444" y="463.4688">cmt-handler</text><!--entity ach--><rect fill="#FEFECE" filter="url(#ffuskvgu2np5n)" height="72.9766" style="stroke: #A80036; stroke-width: 3.0;" width="206" x="527.9444" y="416.3984"/><rect fill="#FEFECE" height="10" style="stroke: #A80036; stroke-width: 3.0;" width="20" x="517.9444" y="426.3984"/><rect fill="#FEFECE" height="10" style="stroke: #A80036; stroke-width: 3.0;" width="20" x="517.9444" y="469.375"/><text fill="#000000" font-family="sans-serif" font-size="28" lengthAdjust="spacingAndGlyphs" textLength="166" x="547.9444" y="463.4688">cac-handler</text><!--entity balance--><path d="M321.9444,672.3984 C321.9444,652.3984 394.9444,652.3984 394.9444,652.3984 C394.9444,652.3984 467.9444,652.3984 467.9444,672.3984 L467.9444,723.375 C467.9444,743.375 394.9444,743.375 394.9444,743.375 C394.9444,743.375 321.9444,743.375 321.9444,723.375 L321.9444,672.3984 " fill="#FEFECE" filter="url(#ffuskvgu2np5n)" style="stroke: #000000; stroke-width: 3.0;"/><path d="M321.9444,672.3984 C321.9444,692.3984 394.9444,692.3984 394.9444,692.3984 C394.9444,692.3984 467.9444,692.3984 467.9444,672.3984 " fill="none" style="stroke: #000000; stroke-width: 3.0;"/><text fill="#000000" font-family="sans-serif" font-size="28" lengthAdjust="spacingAndGlyphs" textLength="106" x="341.9444" y="727.4688">balance</text><!--entity cac--><path d="M538.9444,672.3984 C538.9444,652.3984 580.9444,652.3984 580.9444,652.3984 C580.9444,652.3984 622.9444,652.3984 622.9444,672.3984 L622.9444,723.375 C622.9444,743.375 580.9444,743.375 580.9444,743.375 C580.9444,743.375 538.9444,743.375 538.9444,723.375 L538.9444,672.3984 " fill="#FEFECE" filter="url(#ffuskvgu2np5n)" style="stroke: #000000; stroke-width: 3.0;"/><path d="M538.9444,672.3984 C538.9444,692.3984 580.9444,692.3984 580.9444,692.3984 C580.9444,692.3984 622.9444,692.3984 622.9444,672.3984 " fill="none" style="stroke: #000000; stroke-width: 3.0;"/><text fill="#000000" font-family="sans-serif" font-size="28" lengthAdjust="spacingAndGlyphs" textLength="44" x="558.9444" y="727.4688">cac</text><!--entity cmt--><path d="M161.9444,672.3984 C161.9444,652.3984 206.9444,652.3984 206.9444,652.3984 C206.9444,652.3984 251.9444,652.3984 251.9444,672.3984 L251.9444,723.375 C251.9444,743.375 206.9444,743.375 206.9444,743.375 C206.9444,743.375 161.9444,743.375 161.9444,723.375 L161.9444,672.3984 " fill="#FEFECE" filter="url(#ffuskvgu2np5n)" style="stroke: #000000; stroke-width: 3.0;"/><path d="M161.9444,672.3984 C161.9444,692.3984 206.9444,692.3984 206.9444,692.3984 C206.9444,692.3984 251.9444,692.3984 251.9444,672.3984 " fill="none" style="stroke: #000000; stroke-width: 3.0;"/><text fill="#000000" font-family="sans-serif" font-size="28" lengthAdjust="spacingAndGlyphs" textLength="50" x="181.9444" y="727.4688">cmt</text><!--entity kc--><rect fill="#FFA500" filter="url(#ffuskvgu2np5n)" height="72.9766" style="stroke: #A80036; stroke-width: 3.0;" width="216" x="898.9444" y="58.3984"/><rect fill="#FFA500" height="10" style="stroke: #A80036; stroke-width: 3.0;" width="20" x="888.9444" y="68.3984"/><rect fill="#FFA500" height="10" style="stroke: #A80036; stroke-width: 3.0;" width="20" x="888.9444" y="111.375"/><text fill="#000000" font-family="sans-serif" font-size="28" lengthAdjust="spacingAndGlyphs" textLength="176" x="918.9444" y="105.4688">Kafka cluster</text><!--link mth to cmt--><path d="M244.2284,469.5072 C159.0954,485.5904 49.8058,512.5484 22.9444,548.3984 C-20.516,606.4022 83.1864,655.1908 151.944,679.9404 " fill="none" id="mth-cmt" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="161.8134,683.4158,147.4924,669.8914,152.3811,680.0944,142.1781,684.9831,161.8134,683.4158" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="26" lengthAdjust="spacingAndGlyphs" textLength="260" x="24.9444" y="575.5352">check/update status</text><!--link ach to cac--><path d="M723.1608,488.5186 C784.5466,513.0016 854.7128,542.025 858.9444,548.3984 C867.3032,560.9872 867.3426,569.836 858.9444,582.3984 C808.659,657.618 699.1304,683.6966 633.563,692.6968 " fill="none" id="ach-cac" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="623.4332,693.9994,642.3067,699.6378,633.3515,692.7237,640.2656,683.7685,623.4332,693.9994" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="26" lengthAdjust="spacingAndGlyphs" textLength="260" x="868.9444" y="575.5352">check/update status</text><!--link mth to balance--><path d="M324.4398,488.7668 C308.801,514.8032 294.0194,550.712 304.9444,582.3984 C312.5434,604.4376 326.295,625.4814 340.799,643.4014 " fill="none" id="mth-balance" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="347.9558,651.9382,342.5221,633.0048,341.5312,644.2751,330.261,643.2842,347.9558,651.9382" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="26" lengthAdjust="spacingAndGlyphs" textLength="278" x="306.9444" y="575.5352">check/update balance</text><!--link ach to balance--><path d="M630.9256,488.6704 C628.8568,518.2282 620.9704,558.805 594.9444,582.3984 C564.196,610.2732 540.1868,580.0824 502.9444,598.3984 C479.9772,609.6938 458.379,627.4052 440.6222,644.7434 " fill="none" id="ach-balance" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="433.2546,652.1316,451.6296,645.0353,440.3159,645.0509,440.3004,633.7372,433.2546,652.1316" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="26" lengthAdjust="spacingAndGlyphs" textLength="180" x="620.9444" y="575.5352">crates balance</text><!--link kc to p--><path d="M898.595,114.4138 C855.6756,128.223 810.5394,151.4448 784.9444,190.3984 C746.8714,248.3428 759.0288,282.0906 784.9444,346.3984 C794.5502,370.2344 812.3638,391.7092 830.4484,408.9964 " fill="none" id="kc-p" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="838.1926,416.1436,830.391,398.0567,830.8441,409.3614,819.5394,409.8144,838.1926,416.1436" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="26" lengthAdjust="spacingAndGlyphs" textLength="350" x="786.9444" y="217.5352">AccountCreationConfirmed,</text><text fill="#000000" font-family="sans-serif" font-size="26" lengthAdjust="spacingAndGlyphs" textLength="292" x="815.9444" y="248.1563">AccountCreationFailed,</text><text fill="#000000" font-family="sans-serif" font-size="26" lengthAdjust="spacingAndGlyphs" textLength="326" x="798.9444" y="278.7773">MoneyTransferConfirmed,</text><text fill="#000000" font-family="sans-serif" font-size="26" lengthAdjust="spacingAndGlyphs" textLength="314" x="804.9444" y="309.3984">MoneyTransferFailed and</text><text fill="#000000" font-family="sans-serif" font-size="26" lengthAdjust="spacingAndGlyphs" textLength="204" x="859.9444" y="340.0195">BalanceChanged</text><!--link c to kc--><path d="M1146.0722,406.2482 C1163.4056,351.4104 1182.954,258.7528 1146.9444,190.3984 C1133.758,165.3672 1110.7738,145.6094 1087.1946,130.69 " fill="none" id="c-kc" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1142.8754,416.033,1156.07,401.4076,1145.9811,406.5275,1140.8612,396.4386,1142.8754,416.033" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="26" lengthAdjust="spacingAndGlyphs" textLength="312" x="1187.9444" y="263.5352">ConfirmAccountCreation</text><text fill="#000000" font-family="sans-serif" font-size="26" lengthAdjust="spacingAndGlyphs" textLength="342" x="1176.9444" y="294.1563">and ConfirmMoneyTransfer</text><!--
@startuml

title Command handler

package "nl.openweb.command-handler.core.clj" #Yellow {
    component consumer as c
    component producer as p
    component "cmt-handler" as mth
    component "cac-handler" as ach
}
package balancedb #LightBlue{
    database balance
    database cac
    database cmt
}
[Kafka cluster] as kc #Orange

mth - -> cmt :check/update status
ach - -> cac :check/update status
mth - -> balance :check/update balance
ach - -> balance :crates balance
kc - -> p :AccountCreationConfirmed,\nAccountCreationFailed,\nMoneyTransferConfirmed,\nMoneyTransferFailed and\nBalanceChanged
c <- - kc :ConfirmAccountCreation\n and ConfirmMoneyTransfer

@enduml

PlantUML version 1.2019.05(Sat Apr 20 18:45:36 CEST 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_202-release-1483-b49
Operating System: Mac OS X
OS Version: 10.14.5
Default Encoding: UTF-8
Language: en
Country: NL
--></g></svg>